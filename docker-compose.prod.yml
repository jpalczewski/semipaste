version: "3.9"  # optional since v1.27.0
services:
  backend:
    image:  jpalczewski/semipaste-backend:prod-latest
    command:  gunicorn backend.asgi:application -k uvicorn.workers.UvicornWorker -b 0.0.0.0:8000
    build:
      context: backend
      args:
        - PRODUCTION=YES
  proxy:
    image: jpalczewski/semipaste-proxy:latest
    build:
      context: frontend
      dockerfile: ../proxy/Dockerfile
#    volumes:
#      - "./proxy/nginx.conf:/etc/nginx/nginx.conf:ro"
    ports:
      - "3030:80"
  frontend: {}
